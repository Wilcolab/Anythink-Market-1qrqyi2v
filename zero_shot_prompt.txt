import re

def to_snake_case(text):
    """
    Convert text to snake_case format.
    
    Handles:
    - Space and dash conversion to underscores
    - CamelCase to snake_case conversion
    - Mixed case transitions
    - Final conversion to lowercase
    
    Args:
        text (str): Input text to convert
        
    Returns:
        str: Text converted to snake_case format
        
    Examples:
        >>> to_snake_case("helloWorld")
        'hello_world'
        >>> to_snake_case("HelloWorld")
        'hello_world'
        >>> to_snake_case("hello-world")
        'hello_world'
        >>> to_snake_case("hello world")
        'hello_world'
        >>> to_snake_case("HELLO_WORLD")
        'hello_world'
        >>> to_snake_case("getHTTPResponseCode")
        'get_http_response_code'
    """
    # Replace spaces and dashes with underscores
    text = text.replace(' ', '_').replace('-', '_')
    
    # Insert underscore before uppercase letters that follow lowercase letters
    # This handles cases like "helloWorld" -> "hello_World"
    text = re.sub('([a-z])([A-Z])', r'\1_\2', text)
    
    # Insert underscore before uppercase letters that are followed by lowercase letters
    # and preceded by uppercase letters
    # This handles cases like "getHTTPResponseCode" -> "get_HTTP_Response_Code"
    text = re.sub('([A-Z]+)([A-Z][a-z])', r'\1_\2', text)
    
    # Convert to lowercase
    text = text.lower()
    
    # Replace multiple consecutive underscores with a single underscore
    text = re.sub('_+', '_', text)
    
    # Remove leading and trailing underscores
    text = text.strip('_')
    
    return text
